# GitVersion Go

A command-line tool, written in Go, to help you with semantic versioning based on your Git history and Conventional Commits.

## Features

-   **Dual Versioning**: Supports both **Conventional Commits** and **legacy semver bump messages** (e.g., `+semver: major`) for maximum flexibility. The tool can be configured to use either or both methods.
-   **Branch-Based Configuration**: Highly configurable versioning strategies for different types of branches (e.g., `main`, `develop`, `feature`, `release`).
-   **Prerelease Tags**: Automatically generates prerelease tags (e.g., `-alpha.1`, `-beta.3`, `-feature-new-stuff.5`) based on branch configuration and commit history.
-   **Simple Setup**: Get started quickly with a single configuration file.

## Installation

To install the tool, you can use `go install`:

```sh
go install gitversion-go
```

## Usage

The tool has two main commands: `init` and `calculate`.

### `init`

This command creates a default `GitVersion.yml` configuration file in the current directory.

```sh
gitversion-go init
```

### `calculate`

This command analyzes the Git history, reads the `GitVersion.yml` configuration, and calculates the next version. It outputs the version variables in JSON format.

```sh
gitversion-go calculate
```

**Example Output:**

```json
{
  "Major": "1",
  "Minor": "2",
  "Patch": "4",
  "Prerelease": "alpha.5",
  "FullSemVer": "1.2.4-alpha.5"
}
```

## Configuration

Versioning behavior is controlled by a `GitVersion.yml` file.

**By default, GitVersion Go uses both Conventional Commits and legacy semver bump messages.**

-   **Conventional Commits** (`feat:`, `fix:`, `BREAKING CHANGE:`) are always enabled and do not require any specific configuration.
-   **Legacy semver bump messages** (e.g., `+semver: major`) are enabled through the `...-version-bump-message` configuration options. The `init` command includes these by default, but you can remove them from your `GitVersion.yml` if you only want to use Conventional Commits.

When both methods are active, the highest detected version bump takes precedence (e.g., a `major` bump will be chosen over a `minor` or `patch` bump).

Here is an example configuration generated by the `init` command:

```yaml
next-version: 0.1.0
major-version-bump-message: "^(\\s|\\S)*?(\\+semver:\\s?(breaking|major))"
minor-version-bump-message: "^(\\s|\\S)*?(\\+semver:\\s?(feature|minor))"
patch-version-bump-message: "^(\\s|\\S)*?(\\+semver:\\s?(fix|patch))"
branches:
  main:
    tag: ""
  develop:
    mode: ContinuousDeployment
    tag: alpha
  release:
    tag: beta
  feature:
    tag: use-branch-name
  hotfix:
    tag: beta
```

### Configuration Options

-   `next-version`: The version to start with if no tags are found in the repository.
-   `major-version-bump-message`: A regex pattern to identify commits that should trigger a major version bump.
-   `minor-version-bump-message`: A regex pattern to identify commits that should trigger a minor version bump.
-   `patch-version-bump-message`: A regex pattern to identify commits that should trigger a patch version bump.
-   `no-bump-message`: A regex pattern to identify commits that should not trigger a version bump. If a commit message matches this pattern, it will be ignored.
-   `tag-prefix`: A regex pattern to identify and strip a prefix from version tags. This is useful if your tags are not clean semantic versions (e.g., `release-1.2.3`).
-   `ignore`: A list of commit SHAs to exclude from the version calculation.
-   `increment`: The version bump strategy to use. Can be set globally or per-branch. Possible values are `Major`, `Minor`, `Patch`, `None`, and `Inherit`. If set on a branch, it overrides the global setting. `Inherit` falls back to commit message-based bumping.
-   `branches`: A map of branch configurations. The keys are regex patterns to match against branch names.
    -   `mode`: (Optional) The versioning mode for the branch. `ContinuousDeployment` is a common mode for development branches.
    -   `tag`: The prerelease tag to use for the branch. If set to `use-branch-name`, the branch name will be sanitized and used as the prerelease tag (e.g., `feature/new-stuff` becomes `feature-new-stuff`).

## Credits and Disclaimer

This project is a Go implementation of the core concepts from the original [.NET-based GitVersion](https://github.com/GitTools/GitVersion), created by the talented team at GitTools and its contributors. A huge thank you to them for their foundational work in making semantic versioning from Git history so accessible.

This Go version was developed as an experiment in AI-assisted programming to explore the capabilities of agentic AI in refactoring and building software.

For a detailed comparison of features between this project and the original GitVersion, please see the [Feature Parity Document](parity.md).

The original GitVersion project is licensed under the MIT License, and its copyright notice is included below as required:

```
The MIT License (MIT)

Copyright (c) 2021 NServiceBus Ltd, GitTools and contributors.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```
